


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Session &mdash; PyTorch/Elastic master documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/katex-math.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Overview" href="tsm_driver.html" />
  <!-- Google Analytics -->
  
  <!-- End Google Analytics -->
  

  
  <script src="_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css" integrity="sha384-vSIIfh2YWi9wW0r9iZe7RJPrKwp6bG+s9QZMoITbCckVJqGCCRhc+ccxNcdpHuYu" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-orange-arrow">
                Docs
              </a>
              <div class="resources-dropdown-menu">
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/docs/stable/index.html">
                  <span class="dropdown-title">PyTorch</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/audio/stable/index.html">
                  <span class="dropdown-title">torchaudio</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/text/stable/index.html">
                  <span class="dropdown-title">torchtext</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/vision/stable/index.html">
                  <span class="dropdown-title">torchvision</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/elastic/">
                  <span class="dropdown-title">TorchElastic</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/serve/">
                  <span class="dropdown-title">TorchServe</span>
                  <p></p>
                </a>
                <a class="doc-dropdown-option nav-dropdown-item" href="https://pytorch.org/xla">
                  <span class="dropdown-title">PyTorch on XLA Devices</span>
                  <p></p>
                </a>
            </div>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="resource-option with-down-arrow">
                Resources
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="https://pytorch.org/features">
                  <span class="dropdown-title">About</span>
                  <p>Learn about PyTorch’s features and capabilities</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/#community-module">
                  <span class="dropdown-title">Community</span>
                  <p>Join the PyTorch developer community to contribute, learn, and get your questions answered.</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/resources">
                  <span class="dropdown-title">Developer Resources</span>
                  <p>Find resources and get questions answered</p>
                </a>
                <a class="nav-dropdown-item" href="https://discuss.pytorch.org/" target="_blank">
                  <span class="dropdown-title">Forums</span>
                  <p>A place to discuss PyTorch code, issues, install, research</p>
                </a>
                <a class="nav-dropdown-item" href="https://pytorch.org/hub">
                  <span class="dropdown-title">Models (Beta)</span>
                  <p>Discover, publish, and reuse pre-trained models</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/pytorch/pytorch">GitHub</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

<body class="pytorch-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="pytorch-left-menu" id="pytorch-left-menu">
      <div class="pytorch-side-scroll">
        <div class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="pytorch-left-menu-search">
            

            
              
              
                <div class="version">
                  v0.2.3.dev0
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Training Session Manager(TSM)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tsm_driver.html">Overview</a></li>
</ul>
<p class="caption"><span class="caption-text">TSM API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Session</a></li>
<li class="toctree-l1"><a class="reference internal" href="#containers-and-resource">Containers and Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="#roles-and-applications">Roles and Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="#status-api">Status API</a></li>
<li class="toctree-l1"><a class="reference internal" href="#scheduler">Scheduler</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="pytorch-container">
      <div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
        <div class="pytorch-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="pytorch-breadcrumbs">
    
      <li>
        <a href="index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Session</li>
    
    
      <li class="pytorch-breadcrumbs-aside">
        
            
            <a href="_sources/tsm_api.rst.txt" rel="nofollow"><img src="_static/images/view-page-source-icon.svg"></a>
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="pytorch-content-wrap" class="pytorch-content-wrap">
        <div class="pytorch-content-left">

        
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="pytorch-article" class="pytorch-article">
              
  <div class="section" id="session">
<h1>Session<a class="headerlink" href="#session" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="torchelastic.tsm.driver.api.Session">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchelastic.tsm.driver.api.</span></code><code class="sig-name descname"><span class="pre">Session</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Session"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Session" title="Permalink to this definition">¶</a></dt>
<dd><p>Entrypoint and client-facing API for TSM. Has the methods for the user to
define and act upon <code class="docutils literal notranslate"><span class="pre">Applications</span></code>. The <code class="docutils literal notranslate"><span class="pre">Session</span></code> is stateful and
represents a logical workspace of the user. It can be backed by a service
(e.g. TSM server) for persistence or can be standalone with no persistence
meaning that the <code class="docutils literal notranslate"><span class="pre">Session</span></code> lasts only during the duration of the hosting
process (see the <code class="docutils literal notranslate"><span class="pre">attach()</span></code> API for instructions on re-parenting apps
between sessions).</p>
<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Session.describe">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">describe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_handle</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#torchelastic.tsm.driver.api.Application" title="torchelastic.tsm.driver.api.Application"><span class="pre">torchelastic.tsm.driver.api.Application</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Session.describe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Session.describe" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstructs the application (to the best extent) given the app handle.
Note that the reconstructed application may not be the complete app as
it was submitted via the run API. How much of the app can be reconstructed
is scheduler dependent.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Application or None if the app does not exist anymore or if the
scheduler does not support describing the app handle</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Session.dryrun">
<code class="sig-name descname"><span class="pre">dryrun</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#torchelastic.tsm.driver.api.Application" title="torchelastic.tsm.driver.api.Application"><span class="pre">torchelastic.tsm.driver.api.Application</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torchelastic.tsm.driver.api.RunConfig</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torchelastic.tsm.driver.api.AppDryRunInfo</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Session.dryrun"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Session.dryrun" title="Permalink to this definition">¶</a></dt>
<dd><p>Dry runs an app on the given scheduler with the provided run configs.
Does not actually submit the app but rather returns what would have been
submitted. The returned <code class="docutils literal notranslate"><span class="pre">AppDryRunInfo</span></code> is pretty formatted and can
be printed or logged directly.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dryrun_info</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">dryrun</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dryrun_info</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Session.list">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">list</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="#torchelastic.tsm.driver.api.Application" title="torchelastic.tsm.driver.api.Application"><span class="pre">torchelastic.tsm.driver.api.Application</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Session.list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Session.list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the applications that were run with this session mapped by the app handle.
The persistence of the session is implementation dependent.</p>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Session.log_lines">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">log_lines</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_handle</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">role_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regex</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">since</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.9)"><span class="pre">datetime.datetime</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">until</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.9)"><span class="pre">datetime.datetime</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">should_tail</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Iterable</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Session.log_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Session.log_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator over the log lines of the specified job container.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> is the node (host) id NOT the <code class="docutils literal notranslate"><span class="pre">rank</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">since</span></code> and <code class="docutils literal notranslate"><span class="pre">until</span></code> need not always be honored (depends on scheduler).</p></li>
</ol>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The semantics and guarantees of the returned iterator is highly
scheduler dependent. See <code class="docutils literal notranslate"><span class="pre">torchelastic.tsm.driver.api.Scheduler.log_iter</span></code>
for the high-level semantics of this log iterator. For this reason
it is HIGHLY DISCOURAGED to use this method for generating output
to pass to downstream functions/dependencies. This method
DOES NOT guarantee that 100% of the log lines are returned.
It is totally valid for this method to return no or partial log lines
if the scheduler has already totally or partially purged log records
for the application.</p>
</div>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">app_handle</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">RunConfig</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;== trainer node 0 logs ==&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">session</span><span class="o">.</span><span class="n">log_lines</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="s2">&quot;trainer&quot;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
   <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
<p>Discouraged anti-pattern:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># DO NOT DO THIS!</span>
<span class="c1"># parses accuracy metric from log and reports it for this experiment run</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">session</span><span class="o">.</span><span class="n">log_lines</span><span class="p">(</span><span class="n">app_handle</span><span class="p">,</span> <span class="s2">&quot;trainer&quot;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
   <span class="k">if</span> <span class="n">matches_regex</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="s2">&quot;final model_accuracy:[0-9]*&quot;</span><span class="p">):</span>
       <span class="n">accuracy</span> <span class="o">=</span> <span class="n">parse_accuracy</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
       <span class="k">break</span>
<span class="n">report</span><span class="p">(</span><span class="n">experiment_name</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app_handle</strong> – application handle</p></li>
<li><p><strong>role_name</strong> – role within the app (e.g. trainer)</p></li>
<li><p><strong>k</strong> – k-th replica of the role to fetch the logs for</p></li>
<li><p><strong>regex</strong> – optional regex filter, returns all lines if left empty</p></li>
<li><p><strong>since</strong> – datetime based start cursor. If left empty begins from the
first log line (start of job).</p></li>
<li><p><strong>until</strong> – datetime based end cursor. If left empty, follows the log output
until the job completes and all log lines have been consumed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An iterator over the role k-th replica of the specified application.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>UnknownAppException</strong> – if the app does not exist in the scheduler</p></li>
<li><p><strong>SessionMismatchException</strong> – if the app handle does not belong to this session</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Session.name">
<code class="sig-name descname"><span class="pre">name</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Session.name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Session.name" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The name of this session.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Session.run">
<code class="sig-name descname"><span class="pre">run</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#torchelastic.tsm.driver.api.Application" title="torchelastic.tsm.driver.api.Application"><span class="pre">torchelastic.tsm.driver.api.Application</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torchelastic.tsm.driver.api.RunConfig</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Session.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Session.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs the given application in the specified mode.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>sub-classes of <code class="docutils literal notranslate"><span class="pre">Session</span></code> should implement <code class="docutils literal notranslate"><span class="pre">schedule</span></code> method
rather than overriding this method directly.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An application handle that is used to call other action APIs on the app.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>AppNotReRunnableException</strong> – if the session/scheduler does not support re-running attached apps</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Session.run_opts">
<code class="sig-name descname"><span class="pre">run_opts</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">torchelastic.tsm.driver.api.runopts</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Session.run_opts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Session.run_opts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <code class="docutils literal notranslate"><span class="pre">runopts</span></code> for the supported scheduler backends.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">local_runopts</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run_opts</span><span class="p">()[</span><span class="s2">&quot;local&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;local scheduler run options: </span><span class="si">{local_runopts}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A map of scheduler backend to its <code class="docutils literal notranslate"><span class="pre">runopts</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Session.schedule">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">schedule</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dryrun_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torchelastic.tsm.driver.api.AppDryRunInfo</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Session.schedule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Session.schedule" title="Permalink to this definition">¶</a></dt>
<dd><p>Actually runs the application from the given dryrun info.
Useful when one needs to overwrite a parameter in the scheduler
request that is not configurable from one of the object APIs.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Use sparingly since abusing this method to overwrite
many parameters in the raw scheduler request may
lead to your usage of TSM going out of compliance
in the long term. This method is intended to
unblock the user from experimenting with certain
scheduler-specific features in the short term without
having to wait until TSM exposes scheduler features
in its APIs.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is recommended that sub-classes of <code class="docutils literal notranslate"><span class="pre">Session</span></code> implement
this method instead of directly implementing the <code class="docutils literal notranslate"><span class="pre">run</span></code> method.</p>
</div>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dryrun_info</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">dryrun</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>

<span class="c1"># overwrite parameter &quot;foo&quot; to &quot;bar&quot;</span>
<span class="n">dryrun_info</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="s2">&quot;bar&quot;</span>

<span class="n">app_handle</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">dryrun_info</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Session.scheduler_backends">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">scheduler_backends</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Session.scheduler_backends"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Session.scheduler_backends" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of all supported scheduler backends.
All session implementations must support a “default”
scheduler backend and document what the default
scheduler is.</p>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Session.status">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">status</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_handle</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#torchelastic.tsm.driver.api.AppStatus" title="torchelastic.tsm.driver.api.AppStatus"><span class="pre">torchelastic.tsm.driver.api.AppStatus</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Session.status"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Session.status" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The status of the application, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the app does not exist anymore
(e.g. was stopped in the past and removed from the scheduler’s backend).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Session.stop">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">stop</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_handle</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Session.stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Session.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stops the application, effectively directing the scheduler to cancel
the job. Does nothing if the app does not exist.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method returns as soon as the cancel request has been
submitted to the scheduler. The application will be in a
<code class="docutils literal notranslate"><span class="pre">RUNNING</span></code> state until the scheduler actually terminates
the job. If the scheduler successfully interrupts the job
and terminates it the final state will be <code class="docutils literal notranslate"><span class="pre">CANCELLED</span></code>
otherwise it will be <code class="docutils literal notranslate"><span class="pre">FAILED</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>SessionMismatchException</strong> – if the app handle does not belong to this session</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Session.wait">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">wait</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_handle</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#torchelastic.tsm.driver.api.AppStatus" title="torchelastic.tsm.driver.api.AppStatus"><span class="pre">torchelastic.tsm.driver.api.AppStatus</span></a><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Session.wait"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Session.wait" title="Permalink to this definition">¶</a></dt>
<dd><p>Block waits (indefinitely) for the application to complete.
Possible implementation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">while</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">app_status</span> <span class="o">=</span> <span class="n">status</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">app_status</span><span class="o">.</span><span class="n">is_terminal</span><span class="p">():</span>
        <span class="k">return</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The terminal status of the application, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the app does not exist anymore</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="containers-and-resource">
<h1>Containers and Resource<a class="headerlink" href="#containers-and-resource" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="torchelastic.tsm.driver.api.Container">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchelastic.tsm.driver.api.</span></code><code class="sig-name descname"><span class="pre">Container</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">image:</span> <span class="pre">str</span></em>, <em class="sig-param"><span class="pre">resources:</span> <span class="pre">torchelastic.tsm.driver.api.Resource</span> <span class="pre">=</span> <span class="pre">Resource(cpu=-1</span></em>, <em class="sig-param"><span class="pre">gpu=-1</span></em>, <em class="sig-param"><span class="pre">memMB=-1</span></em>, <em class="sig-param"><span class="pre">capabilities={})</span></em>, <em class="sig-param"><span class="pre">port_map:</span> <span class="pre">Dict[str</span></em>, <em class="sig-param"><span class="pre">int]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Container"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Container" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the specifications of the container that instances of <code class="docutils literal notranslate"><span class="pre">Roles</span></code>
run on. Maps to the container abstraction that the underlying scheduler
supports. This could be an actual container (e.g. Docker) or a physical
instance depending on the scheduler.</p>
<p>An <code class="docutils literal notranslate"><span class="pre">image</span></code> is a software bundle that is installed on a <code class="docutils literal notranslate"><span class="pre">Container</span></code>.
The container on the scheduler dictates what an image actually is.
An image could be as simple as a tar-ball or map to a docker image.
The scheduler typically knows how to “pull” the image given an
image name (str), which could be a simple name (e.g. docker image) or a url
(e.g. s3://path/my_image.tar).</p>
<p>A <code class="docutils literal notranslate"><span class="pre">Resource</span></code> can be bound to a specific scheduler backend or <code class="docutils literal notranslate"><span class="pre">SchedulerBackend.ALL</span></code> (default)
to specify that the same <code class="docutils literal notranslate"><span class="pre">Resource</span></code> is to be used for all schedulers.</p>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># define resource for all schedulers</span>
<span class="n">my_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="s2">&quot;pytorch/torch:1&quot;</span><span class="p">)</span>
                  <span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="n">Resource</span><span class="p">(</span><span class="n">cpu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gpu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">memMB</span><span class="o">=</span><span class="mi">500</span><span class="p">))</span>
                  <span class="o">.</span><span class="n">ports</span><span class="p">(</span><span class="n">tcp_store</span><span class="o">=</span><span class="mi">8080</span><span class="p">,</span> <span class="n">tensorboard</span><span class="o">=</span><span class="mi">8081</span><span class="p">)</span>

<span class="c1"># define resource for a specific scheduler</span>
<span class="n">my_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="s2">&quot;pytorch/torch:1&quot;</span><span class="p">)</span>
                  <span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="n">Resource</span><span class="p">(</span><span class="n">cpu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">gpu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">memMB</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span> <span class="s2">&quot;custom_scheduler&quot;</span><span class="p">)</span>
                  <span class="o">.</span><span class="n">ports</span><span class="p">(</span><span class="n">tcp_store</span><span class="o">=</span><span class="mi">8080</span><span class="p">,</span> <span class="n">tensorboard</span><span class="o">=</span><span class="mi">8081</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="torchelastic.tsm.driver.api.Resource">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchelastic.tsm.driver.api.</span></code><code class="sig-name descname"><span class="pre">Resource</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">cpu:</span> <span class="pre">int</span></em>, <em class="sig-param"><span class="pre">gpu:</span> <span class="pre">int</span></em>, <em class="sig-param"><span class="pre">memMB:</span> <span class="pre">int</span></em>, <em class="sig-param"><span class="pre">capabilities:</span> <span class="pre">Dict[str</span></em>, <em class="sig-param"><span class="pre">Any]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Resource"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Resource" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents resource requirements for a <code class="docutils literal notranslate"><span class="pre">Container</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cpu</strong> – number of cpu cores (note: not hyper threads)</p></li>
<li><p><strong>gpu</strong> – number of gpus</p></li>
<li><p><strong>memMB</strong> – MB of ram</p></li>
<li><p><strong>capabilities</strong> – additional hardware specs (interpreted by scheduler)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="roles-and-applications">
<h1>Roles and Applications<a class="headerlink" href="#roles-and-applications" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="torchelastic.tsm.driver.api.Role">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchelastic.tsm.driver.api.</span></code><code class="sig-name descname"><span class="pre">Role</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">name:</span> <span class="pre">str</span></em>, <em class="sig-param"><span class="pre">entrypoint:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'&lt;MISSING&gt;'</span></em>, <em class="sig-param"><span class="pre">args:</span> <span class="pre">List[str]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em>, <em class="sig-param"><span class="pre">env:</span> <span class="pre">Dict[str</span></em>, <em class="sig-param"><span class="pre">str]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em>, <em class="sig-param"><span class="pre">container:</span> <span class="pre">torchelastic.tsm.driver.api.Container</span> <span class="pre">=</span> <span class="pre">Container(image='&lt;MISSING&gt;'</span></em>, <em class="sig-param"><span class="pre">resources=Resource(cpu=-1</span></em>, <em class="sig-param"><span class="pre">gpu=-1</span></em>, <em class="sig-param"><span class="pre">memMB=-1</span></em>, <em class="sig-param"><span class="pre">capabilities={})</span></em>, <em class="sig-param"><span class="pre">port_map={})</span></em>, <em class="sig-param"><span class="pre">num_replicas:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></em>, <em class="sig-param"><span class="pre">max_retries:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></em>, <em class="sig-param"><span class="pre">retry_policy:</span> <span class="pre">torchelastic.tsm.driver.api.RetryPolicy</span> <span class="pre">=</span> <span class="pre">&lt;RetryPolicy.APPLICATION:</span> <span class="pre">'APPLICATION'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Role"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Role" title="Permalink to this definition">¶</a></dt>
<dd><p>A set of nodes that perform a specific duty within the <code class="docutils literal notranslate"><span class="pre">Application</span></code>.
Examples:</p>
<ol class="arabic simple">
<li><p>Distributed data parallel app - made up of a single role (trainer).</p></li>
<li><p>App with parameter server - made up of multiple roles (trainer, ps).</p></li>
</ol>
<p>Usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">trainer</span> <span class="o">=</span> <span class="n">Role</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;trainer&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="s2">&quot;my_trainer.py&quot;</span><span class="p">,</span> <span class="s2">&quot;--arg&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="n">ENV_VAR</span><span class="o">=</span><span class="s2">&quot;FOOBAR&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
            <span class="o">.</span><span class="n">replicas</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – name of the role</p></li>
<li><p><strong>entrypoint</strong> – command (within the container) to invoke the role</p></li>
<li><p><strong>args</strong> – commandline arguments to the entrypoint cmd</p></li>
<li><p><strong>env</strong> – environment variable mappings</p></li>
<li><p><strong>container</strong> – container to run in</p></li>
<li><p><strong>replicas</strong> – number of container replicas to run</p></li>
<li><p><strong>max_retries</strong> – max number of retries before giving up</p></li>
<li><p><strong>retry_policy</strong> – retry behavior upon replica failures</p></li>
<li><p><strong>deployment_preference</strong> – hint to the scheduler on how to best
deploy and manage replicas of this role</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="torchelastic.tsm.driver.api.ElasticRole">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchelastic.tsm.driver.api.</span></code><code class="sig-name descname"><span class="pre">ElasticRole</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">launch_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#ElasticRole"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.ElasticRole" title="Permalink to this definition">¶</a></dt>
<dd><p>A <code class="docutils literal notranslate"><span class="pre">Role</span></code> for which the user provided <code class="docutils literal notranslate"><span class="pre">entrypoint</span></code> is executed with the
torchelastic agent (in the container). Note that the torchelastic agent
invokes multiple copies of <code class="docutils literal notranslate"><span class="pre">entrypoint</span></code>.</p>
<p>For more information about torchelastic see
<a class="reference external" href="http://pytorch.org/elastic/0.2.0/quickstart.html">torchelastic quickstart docs</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>It is the responsibility of the user to ensure that the
container’s image includes torchelastic. Since TSM has no
control over the build process of the image, it cannot
automatically include torchelastic in the container’s image.</p>
</div>
<p>The following example launches 2 <code class="docutils literal notranslate"><span class="pre">replicas</span></code> (nodes) of an elastic <code class="docutils literal notranslate"><span class="pre">my_train_script.py</span></code>
that is allowed to scale between 2 to 4 nodes. Each node runs 8 workers which are allowed
to fail and restart a maximum of 3 times.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">replicas</span></code> MUST BE an integer between (inclusive) <code class="docutils literal notranslate"><span class="pre">nnodes</span></code>. That is,
<code class="docutils literal notranslate"><span class="pre">ElasticRole(&quot;trainer&quot;,</span> <span class="pre">nnodes=&quot;2:4&quot;).replicas(5)</span></code> is invalid and will
result in undefined behavior.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">elastic_trainer</span> <span class="o">=</span> <span class="n">ElasticRole</span><span class="p">(</span><span class="s2">&quot;trainer&quot;</span><span class="p">,</span> <span class="n">nproc_per_node</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">nnodes</span><span class="o">=</span><span class="s2">&quot;2:4&quot;</span><span class="p">,</span> <span class="n">max_restarts</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                   <span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="s2">&quot;my_train_script.py&quot;</span><span class="p">,</span> <span class="s2">&quot;--script_arg&quot;</span><span class="p">,</span> <span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;--another_arg&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">)</span>
                   <span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">container</span><span class="p">)</span>
                   <span class="o">.</span><span class="n">replicas</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># effectively runs:</span>
<span class="c1">#    python -m torchelastic.distributed.launch</span>
<span class="c1">#        --nproc_per_node 8</span>
<span class="c1">#        --nnodes 2:4</span>
<span class="c1">#        --max_restarts 3</span>
<span class="c1">#        my_train_script.py --script_arg foo --another_arg bar</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="torchelastic.tsm.driver.api.macros">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchelastic.tsm.driver.api.</span></code><code class="sig-name descname"><span class="pre">macros</span></code><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#macros"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.macros" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines macros that can be used with <code class="docutils literal notranslate"><span class="pre">Role.entrypoint</span></code> and <code class="docutils literal notranslate"><span class="pre">Role.args</span></code>.
The macros will be substituted at runtime to their actual values.</p>
<p>Available macros:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">img_root</span></code> - root directory of the pulled image on the container</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">app_id</span></code> - application id as assigned by the scheduler</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">replica_id</span></code> - unique id for each instance of a replica of a Role,</dt><dd><p>for instance a role with 3 replicas could have the 0, 1, 2
as replica ids. Note that when the container fails and is
replaced, the new container will have the same <code class="docutils literal notranslate"><span class="pre">replica_id</span></code>
as the one it is replacing. For instance if node 1 failed and
was replaced by the scheduler the replacing node will also
have <code class="docutils literal notranslate"><span class="pre">replica_id=1</span></code>.</p>
</dd>
</dl>
</li>
</ol>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># runs: hello_world.py --app_id ${app_id}</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Role</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;trainer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">runs</span><span class="p">(</span><span class="s2">&quot;hello_world.py&quot;</span><span class="p">,</span> <span class="s2">&quot;--app_id&quot;</span><span class="p">,</span> <span class="n">macros</span><span class="o">.</span><span class="n">app_id</span><span class="p">)</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Application</span><span class="p">(</span><span class="s2">&quot;train_app&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="n">trainer</span><span class="p">)</span>
<span class="n">app_handle</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">RunConfig</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt id="torchelastic.tsm.driver.api.RetryPolicy">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchelastic.tsm.driver.api.</span></code><code class="sig-name descname"><span class="pre">RetryPolicy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#RetryPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.RetryPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the retry policy for the <code class="docutils literal notranslate"><span class="pre">Roles</span></code> in the <code class="docutils literal notranslate"><span class="pre">Application</span></code>.
The policy defines the behavior when the role replica encounters a failure:</p>
<ol class="arabic simple">
<li><p>unsuccessful (non zero) exit code</p></li>
<li><p>hardware/host crashes</p></li>
<li><p>preemption</p></li>
<li><p>eviction</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Not all retry policies are supported by all schedulers.
However all schedulers must support <code class="docutils literal notranslate"><span class="pre">RetryPolicy.APPLICATION</span></code>.
Please refer to the scheduler’s documentation for more information
on the retry policies they support and behavior caveats (if any).</p>
</div>
<ol class="arabic simple">
<li><dl class="simple">
<dt>REPLICA: Replaces the replica instance. Surviving replicas are untouched.</dt><dd><p>Use with <code class="docutils literal notranslate"><span class="pre">ElasticRole</span></code> to have torchelastic coordinate restarts
and membership changes. Otherwise, it is up to the application to
deal with failed replica departures and replacement replica admittance.</p>
</dd>
</dl>
</li>
<li><p>APPLICATION: Restarts the entire application.</p></li>
</ol>
</dd></dl>

<dl class="py class">
<dt id="torchelastic.tsm.driver.api.Application">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchelastic.tsm.driver.api.</span></code><code class="sig-name descname"><span class="pre">Application</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">name:</span> <span class="pre">str</span></em>, <em class="sig-param"><span class="pre">roles:</span> <span class="pre">List[torchelastic.tsm.driver.api.Role]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em>, <em class="sig-param"><span class="pre">metadata:</span> <span class="pre">Dict[str</span></em>, <em class="sig-param"><span class="pre">str]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Application"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Application" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents a distributed application made up of multiple <code class="docutils literal notranslate"><span class="pre">Roles</span></code>
and metadata. Contains the necessary information for the driver
to submit this app to the scheduler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of application</p></li>
<li><p><strong>roles</strong> – List of roles</p></li>
<li><p><strong>metadata</strong> – Application specific configuration, in comparison
<code class="docutils literal notranslate"><span class="pre">RunConfig</span></code> is runtime specific configuration.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="status-api">
<h1>Status API<a class="headerlink" href="#status-api" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="torchelastic.tsm.driver.api.AppStatus">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchelastic.tsm.driver.api.</span></code><code class="sig-name descname"><span class="pre">AppStatus</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="pre">state:</span> <span class="pre">torchelastic.tsm.driver.api.AppState</span></em>, <em class="sig-param"><span class="pre">num_restarts:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></em>, <em class="sig-param"><span class="pre">msg:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">''</span></em>, <em class="sig-param"><span class="pre">structured_error_msg:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'&lt;NONE&gt;'</span></em>, <em class="sig-param"><span class="pre">ui_url:</span> <span class="pre">Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></em>, <em class="sig-param"><span class="pre">roles:</span> <span class="pre">List[torchelastic.tsm.driver.api.RoleStatus]</span> <span class="pre">=</span> <span class="pre">&lt;factory&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#AppStatus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.AppStatus" title="Permalink to this definition">¶</a></dt>
<dd><p>The runtime status of the <code class="docutils literal notranslate"><span class="pre">Application</span></code>. The scheduler can
return an arbitrary text message (msg field).
If any error occurs, scheduler can populate <code class="docutils literal notranslate"><span class="pre">structured_error_msg</span></code>
with json response.</p>
<p><code class="docutils literal notranslate"><span class="pre">replicas</span></code> represent the statuses of the replicas in the job. If the job
runs with multiple retries, the parameter will contain the statuses of the
most recent retry. Note: if the previous retries failed, but the most recent
retry succeeded or in progress, <code class="docutils literal notranslate"><span class="pre">replicas</span></code> will not contain ocurred errors.</p>
</dd></dl>

<dl class="py class">
<dt id="torchelastic.tsm.driver.api.RoleStatus">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchelastic.tsm.driver.api.</span></code><code class="sig-name descname"><span class="pre">RoleStatus</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">role</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">replicas</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#torchelastic.tsm.driver.api.ReplicaStatus" title="torchelastic.tsm.driver.api.ReplicaStatus"><span class="pre">torchelastic.tsm.driver.api.ReplicaStatus</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#RoleStatus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.RoleStatus" title="Permalink to this definition">¶</a></dt>
<dd><p>The status of the role during the job execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>role</strong> – Role name</p></li>
<li><p><strong>replicas</strong> – List of replica statuses</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="torchelastic.tsm.driver.api.ReplicaStatus">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchelastic.tsm.driver.api.</span></code><code class="sig-name descname"><span class="pre">ReplicaStatus</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torchelastic.tsm.driver.api.AppState</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">role</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">hostname</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">structured_error_msg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'&lt;NONE&gt;'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#ReplicaStatus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.ReplicaStatus" title="Permalink to this definition">¶</a></dt>
<dd><p>The status of the replica during the job execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> – The node rank, note: this is not a worker rank.</p></li>
<li><p><strong>state</strong> – The current state of the node.</p></li>
<li><p><strong>role</strong> – The role name</p></li>
<li><p><strong>hostname</strong> – The hostname where the replica is running</p></li>
<li><p><strong>structured_error_msg</strong> – Error message if any, None if job succeeded.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="section" id="extending-tsm">
<h2>Extending TSM<a class="headerlink" href="#extending-tsm" title="Permalink to this headline">¶</a></h2>
<p>TSM is built in a “plug-n-play” manner. While it ships out-of-the-box
with certain schedulers and session implementations, you can implement
your own to fit the needs of your PyTorch application and infrastructure.
This section introduces the interfaces that were meant to be subclassed
and extended.</p>
</div>
</div>
<div class="section" id="scheduler">
<h1>Scheduler<a class="headerlink" href="#scheduler" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="torchelastic.tsm.driver.api.Scheduler">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchelastic.tsm.driver.api.</span></code><code class="sig-name descname"><span class="pre">Scheduler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">session_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Scheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>An interface abstracting functionalities of a scheduler.
Implementors need only implement those methods annotated with
<code class="docutils literal notranslate"><span class="pre">&#64;abc.abstractmethod</span></code>.</p>
<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Scheduler.cancel">
<code class="sig-name descname"><span class="pre">cancel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><span class="pre">None</span></a><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Scheduler.cancel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Scheduler.cancel" title="Permalink to this definition">¶</a></dt>
<dd><p>Cancels/kills the application. This method is idempotent within the same
thread and is safe to call on the same application multiple times.
However when called from multiple threads/processes on the same app
the exact semantics of this method depends on the idempotency guarantees
of the underlying scheduler API.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method does not block for the application to reach a
cancelled state. To ensure that the application reaches a
terminal state use the <code class="docutils literal notranslate"><span class="pre">wait</span></code> API.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Scheduler.describe">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">describe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torchelastic.tsm.driver.api.DescribeAppResponse</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Scheduler.describe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Scheduler.describe" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes the specified application.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Application description or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the app does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Scheduler.exists">
<code class="sig-name descname"><span class="pre">exists</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Scheduler.exists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Scheduler.exists" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the app exists (was submitted), <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Scheduler.log_iter">
<code class="sig-name descname"><span class="pre">log_iter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">role_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regex</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">since</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.9)"><span class="pre">datetime.datetime</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">until</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.9)"><span class="pre">datetime.datetime</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">should_tail</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Iterable</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Scheduler.log_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Scheduler.log_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator to the log lines of the <code class="docutils literal notranslate"><span class="pre">k``th</span> <span class="pre">replica</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">``role</span></code>.
The iterator ends end all qualifying log lines have been read.</p>
<p>If the scheduler supports time-based cursors fetching log lines
for custom time ranges, then the <code class="docutils literal notranslate"><span class="pre">since</span></code>, <code class="docutils literal notranslate"><span class="pre">until</span></code> fields are
honored, otherwise they are ignored. Not specifying <code class="docutils literal notranslate"><span class="pre">since</span></code> and <code class="docutils literal notranslate"><span class="pre">until</span></code>
is equivalent to getting all available log lines. If the <code class="docutils literal notranslate"><span class="pre">until</span></code> is
empty, then the iterator behaves like <code class="docutils literal notranslate"><span class="pre">tail</span> <span class="pre">-f</span></code>, following the log output
until the job reaches a terminal state.</p>
<p>The exact definition of what constitutes a log is scheduler specific. Some
schedulers may consider stderr or stdout as the log, others may read the logs
from a log file.</p>
<p>Behaviors and assumptions:</p>
<ol class="arabic simple">
<li><p>Produces an undefined-behavior if called on an app that does not exist
The caller should check that the app exists using <code class="docutils literal notranslate"><span class="pre">exists(app_id)</span></code>
prior to calling this method.</p></li>
<li><p>Is not stateful, calling this method twice with same parameters
returns a new iterator. Prior iteration
progress is lost.</p></li>
<li><p>Does not always support log-tailing. Not all schedulers support live
log iteration (e.g. tailing logs while the app is running). Refer to
the specific scheduler’s documentation for the iterator’s behavior.</p></li>
</ol>
<dl class="simple">
<dt>3.1 If the scheduler supports log-tailing, it should be controlled</dt><dd><p>by``should_tail`` parameter.</p>
</dd>
</dl>
<ol class="arabic" start="4">
<li><p>Does not guarantee log retention. It is possible that by the time this
method is called, the underlying scheduler may have purged the log records
for this application. If so this method raises an arbitrary exception.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">should_tail</span></code> is True, the method only raises a <code class="docutils literal notranslate"><span class="pre">StopIteration</span></code> exception
when the accessible log lines have been fully exhausted and the app has reached
a final state. For instance, if the app gets stuck and does not produce any log lines,
then the iterator blocks until the app eventually gets killed (either via
timeout or manually) at which point it raises a <code class="docutils literal notranslate"><span class="pre">StopIteration</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">should_tail</span></code> is False, the method raises <code class="docutils literal notranslate"><span class="pre">StopIteration</span></code>
when there are no more logs.</p>
</li>
<li><p>Need not be supported by all schedulers.</p></li>
<li><p>Some schedulers may support line cursors by supporting <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>
(e.g. <code class="docutils literal notranslate"><span class="pre">iter[50]</span></code> seeks to the 50th log line).</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An <code class="docutils literal notranslate"><span class="pre">Iterator</span></code> over log lines of the specified role replica</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError - if the scheduler does not support log iteration</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Scheduler.run_opts">
<code class="sig-name descname"><span class="pre">run_opts</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">torchelastic.tsm.driver.api.runopts</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Scheduler.run_opts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Scheduler.run_opts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the run configuration options expected by the scheduler.
Basically a <code class="docutils literal notranslate"><span class="pre">--help</span></code> for the <code class="docutils literal notranslate"><span class="pre">run</span></code> API.</p>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Scheduler.schedule">
<em class="property"><span class="pre">abstract</span> </em><code class="sig-name descname"><span class="pre">schedule</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dryrun_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torchelastic.tsm.driver.api.AppDryRunInfo</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Scheduler.schedule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Scheduler.schedule" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <code class="docutils literal notranslate"><span class="pre">submit</span></code> except that it takes an <code class="docutils literal notranslate"><span class="pre">AppDryrunInfo</span></code>.
Implementors are encouraged to implement this method rather than
directly implementing <code class="docutils literal notranslate"><span class="pre">submit</span></code> since <code class="docutils literal notranslate"><span class="pre">submit</span></code> can be trivially
implemented by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dryrun_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">submit_dryrun</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
<span class="k">return</span> <span class="n">schedule</span><span class="p">(</span><span class="n">dryrun_info</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Scheduler.submit">
<code class="sig-name descname"><span class="pre">submit</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#torchelastic.tsm.driver.api.Application" title="torchelastic.tsm.driver.api.Application"><span class="pre">torchelastic.tsm.driver.api.Application</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torchelastic.tsm.driver.api.RunConfig</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Scheduler.submit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Scheduler.submit" title="Permalink to this definition">¶</a></dt>
<dd><p>Submits the application to be run by the scheduler.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The application id that uniquely identifies the submitted app.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.api.Scheduler.submit_dryrun">
<code class="sig-name descname"><span class="pre">submit_dryrun</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#torchelastic.tsm.driver.api.Application" title="torchelastic.tsm.driver.api.Application"><span class="pre">torchelastic.tsm.driver.api.Application</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torchelastic.tsm.driver.api.RunConfig</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">torchelastic.tsm.driver.api.AppDryRunInfo</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/api.html#Scheduler.submit_dryrun"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.api.Scheduler.submit_dryrun" title="Permalink to this definition">¶</a></dt>
<dd><p>Rather than submitting the request to run the app, returns the
request object that would have been submitted to the underlying
service. The type of the request object is scheduler dependent.
This method can be used to dry-run an application. Please refer
to the scheduler implementation’s documentation regarding
the actual return type.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="torchelastic.tsm.driver.local_scheduler.LocalScheduler">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">torchelastic.tsm.driver.local_scheduler.</span></code><code class="sig-name descname"><span class="pre">LocalScheduler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/local_scheduler.html#LocalScheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.local_scheduler.LocalScheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Schedules on localhost. Containers are modeled as processes and
certain properties of the container that are either not relevant
or that cannot be enforced for localhost
runs are ignored. Properties that are ignored:</p>
<ol class="arabic simple">
<li><p>Resource requirements</p></li>
<li><p>Container limit enforcements</p></li>
<li><p>Retry policies</p></li>
<li><p>Retry counts (no retries supported)</p></li>
<li><p>Deployment preferences</p></li>
</ol>
<dl class="simple">
<dt>..note:: Use this scheduler sparingly since an application</dt><dd><p>that runs successfully on a session backed by this
scheduler may not work on an actual production cluster
using a different scheduler.</p>
</dd>
</dl>
<dl class="py method">
<dt id="torchelastic.tsm.driver.local_scheduler.LocalScheduler.describe">
<code class="sig-name descname"><span class="pre">describe</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">torchelastic.tsm.driver.api.DescribeAppResponse</span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="_modules/torchelastic/tsm/driver/local_scheduler.html#LocalScheduler.describe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.local_scheduler.LocalScheduler.describe" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes the specified application.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Application description or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the app does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.local_scheduler.LocalScheduler.log_iter">
<code class="sig-name descname"><span class="pre">log_iter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">role_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><span class="pre">int</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regex</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">since</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.9)"><span class="pre">datetime.datetime</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">until</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.9)"><span class="pre">datetime.datetime</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">should_tail</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Iterable</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/local_scheduler.html#LocalScheduler.log_iter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.local_scheduler.LocalScheduler.log_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterator to the log lines of the <code class="docutils literal notranslate"><span class="pre">k``th</span> <span class="pre">replica</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">``role</span></code>.
The iterator ends end all qualifying log lines have been read.</p>
<p>If the scheduler supports time-based cursors fetching log lines
for custom time ranges, then the <code class="docutils literal notranslate"><span class="pre">since</span></code>, <code class="docutils literal notranslate"><span class="pre">until</span></code> fields are
honored, otherwise they are ignored. Not specifying <code class="docutils literal notranslate"><span class="pre">since</span></code> and <code class="docutils literal notranslate"><span class="pre">until</span></code>
is equivalent to getting all available log lines. If the <code class="docutils literal notranslate"><span class="pre">until</span></code> is
empty, then the iterator behaves like <code class="docutils literal notranslate"><span class="pre">tail</span> <span class="pre">-f</span></code>, following the log output
until the job reaches a terminal state.</p>
<p>The exact definition of what constitutes a log is scheduler specific. Some
schedulers may consider stderr or stdout as the log, others may read the logs
from a log file.</p>
<p>Behaviors and assumptions:</p>
<ol class="arabic simple">
<li><p>Produces an undefined-behavior if called on an app that does not exist
The caller should check that the app exists using <code class="docutils literal notranslate"><span class="pre">exists(app_id)</span></code>
prior to calling this method.</p></li>
<li><p>Is not stateful, calling this method twice with same parameters
returns a new iterator. Prior iteration
progress is lost.</p></li>
<li><p>Does not always support log-tailing. Not all schedulers support live
log iteration (e.g. tailing logs while the app is running). Refer to
the specific scheduler’s documentation for the iterator’s behavior.</p></li>
</ol>
<dl class="simple">
<dt>3.1 If the scheduler supports log-tailing, it should be controlled</dt><dd><p>by``should_tail`` parameter.</p>
</dd>
</dl>
<ol class="arabic" start="4">
<li><p>Does not guarantee log retention. It is possible that by the time this
method is called, the underlying scheduler may have purged the log records
for this application. If so this method raises an arbitrary exception.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">should_tail</span></code> is True, the method only raises a <code class="docutils literal notranslate"><span class="pre">StopIteration</span></code> exception
when the accessible log lines have been fully exhausted and the app has reached
a final state. For instance, if the app gets stuck and does not produce any log lines,
then the iterator blocks until the app eventually gets killed (either via
timeout or manually) at which point it raises a <code class="docutils literal notranslate"><span class="pre">StopIteration</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">should_tail</span></code> is False, the method raises <code class="docutils literal notranslate"><span class="pre">StopIteration</span></code>
when there are no more logs.</p>
</li>
<li><p>Need not be supported by all schedulers.</p></li>
<li><p>Some schedulers may support line cursors by supporting <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>
(e.g. <code class="docutils literal notranslate"><span class="pre">iter[50]</span></code> seeks to the 50th log line).</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An <code class="docutils literal notranslate"><span class="pre">Iterator</span></code> over log lines of the specified role replica</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError - if the scheduler does not support log iteration</strong> – </p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.local_scheduler.LocalScheduler.run_opts">
<code class="sig-name descname"><span class="pre">run_opts</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; <span class="pre">torchelastic.tsm.driver.api.runopts</span><a class="reference internal" href="_modules/torchelastic/tsm/driver/local_scheduler.html#LocalScheduler.run_opts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.local_scheduler.LocalScheduler.run_opts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the run configuration options expected by the scheduler.
Basically a <code class="docutils literal notranslate"><span class="pre">--help</span></code> for the <code class="docutils literal notranslate"><span class="pre">run</span></code> API.</p>
</dd></dl>

<dl class="py method">
<dt id="torchelastic.tsm.driver.local_scheduler.LocalScheduler.schedule">
<code class="sig-name descname"><span class="pre">schedule</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dryrun_info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">torchelastic.tsm.driver.api.AppDryRunInfo</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a><a class="reference internal" href="_modules/torchelastic/tsm/driver/local_scheduler.html#LocalScheduler.schedule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchelastic.tsm.driver.local_scheduler.LocalScheduler.schedule" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <code class="docutils literal notranslate"><span class="pre">submit</span></code> except that it takes an <code class="docutils literal notranslate"><span class="pre">AppDryrunInfo</span></code>.
Implementors are encouraged to implement this method rather than
directly implementing <code class="docutils literal notranslate"><span class="pre">submit</span></code> since <code class="docutils literal notranslate"><span class="pre">submit</span></code> can be trivially
implemented by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dryrun_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">submit_dryrun</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
<span class="k">return</span> <span class="n">schedule</span><span class="p">(</span><span class="n">dryrun_info</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="tsm_driver.html" class="btn btn-neutral" title="Overview" accesskey="p" rel="prev"><img src="_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  

    <hr>

  

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, PyTorch Elastic Contributors.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="pytorch-content-right" id="pytorch-content-right">
          <div class="pytorch-right-menu" id="pytorch-right-menu">
            <div class="pytorch-side-scroll" id="pytorch-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Session</a></li>
<li><a class="reference internal" href="#containers-and-resource">Containers and Resource</a></li>
<li><a class="reference internal" href="#roles-and-applications">Roles and Applications</a></li>
<li><a class="reference internal" href="#status-api">Status API</a><ul>
<li><a class="reference internal" href="#extending-tsm">Extending TSM</a></li>
</ul>
</li>
<li><a class="reference internal" href="#scheduler">Scheduler</a></li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
         <script src="_static/jquery.js"></script>
         <script src="_static/underscore.js"></script>
         <script src="_static/doctools.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js"></script>
         <script src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js"></script>
         <script src="_static/katex_autorenderer.js"></script>
     

  

  <script type="text/javascript" src="_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="_static/js/vendor/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
    <div class="container">
      <div class="row">
        <div class="col-md-4 text-center">
          <h2>Docs</h2>
          <p>Access comprehensive developer documentation for PyTorch</p>
          <a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Tutorials</h2>
          <p>Get in-depth tutorials for beginners and advanced developers</p>
          <a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
        </div>

        <div class="col-md-4 text-center">
          <h2>Resources</h2>
          <p>Find development resources and get your questions answered</p>
          <a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
        </div>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://pytorch.org/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
            <li><a href="https://pytorch.org/get-started">Get Started</a></li>
            <li><a href="https://pytorch.org/features">Features</a></li>
            <li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
            <li><a href="https://pytorch.org/blog/">Blog</a></li>
            <li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md">Contributing</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://pytorch.org/resources">Resources</a></li>
            <li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
            <li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
            <li><a href="https://discuss.pytorch.org" target="_blank">Discuss</a></li>
            <li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://pytorch.org/assets/brand-guidelines/PyTorch-Brand-Guidelines.pdf" target="_blank">Brand Guidelines</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <ul>
            <li class="list-title">Stay Connected</li>
            <li>
              <div id="mc_embed_signup">
                <form
                  action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&id=91d0dccd39"
                  method="post"
                  id="mc-embedded-subscribe-form"
                  name="mc-embedded-subscribe-form"
                  class="email-subscribe-form validate"
                  target="_blank"
                  novalidate>
                  <div id="mc_embed_signup_scroll" class="email-subscribe-form-fields-wrapper">
                    <div class="mc-field-group">
                      <label for="mce-EMAIL" style="display:none;">Email Address</label>
                      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Email Address">
                    </div>

                    <div id="mce-responses" class="clear">
                      <div class="response" id="mce-error-response" style="display:none"></div>
                      <div class="response" id="mce-success-response" style="display:none"></div>
                    </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->

                    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" value=""></div>

                    <div class="clear">
                      <input type="submit" value="" name="subscribe" id="mc-embedded-subscribe" class="button email-subscribe-button">
                    </div>
                  </div>
                </form>
              </div>

            </li>
          </ul>

          <div class="footer-social-icons">
            <a href="https://www.facebook.com/pytorch" target="_blank" class="facebook"></a>
            <a href="https://twitter.com/pytorch" target="_blank" class="twitter"></a>
            <a href="https://www.youtube.com/pytorch" target="_blank" class="youtube"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <div class="cookie-banner-wrapper">
  <div class="container">
    <p class="gdpr-notice">To analyze traffic and optimize your experience, we serve cookies on this site. By clicking or navigating, you agree to allow our usage of cookies. As the current maintainers of this site, Facebook’s Cookies Policy applies. Learn more, including about available controls: <a href="https://www.facebook.com/policies/cookies/">Cookies Policy</a>.</p>
    <img class="close-button" src="_static/images/pytorch-x.svg">
  </div>
</div>

  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://pytorch.org/" aria-label="PyTorch"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="https://pytorch.org/get-started">Get Started</a>
          </li>

          <li>
            <a href="https://pytorch.org/ecosystem">Ecosystem</a>
          </li>

          <li>
            <a href="https://pytorch.org/mobile">Mobile</a>
          </li>

          <li>
            <a href="https://pytorch.org/hub">PyTorch Hub</a>
          </li>

          <li>
            <a href="https://pytorch.org/blog/">Blog</a>
          </li>

          <li>
            <a href="https://pytorch.org/tutorials">Tutorials</a>
          </li>

          <li class="resources-mobile-menu-title">
            Docs
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/docs/stable/index.html">PyTorch</a>
            </li>

            <li>
              <a href="https://pytorch.org/audio/stable/index.html">torchaudio</a>
            </li>

            <li>
              <a href="https://pytorch.org/text/stable/index.html">torchtext</a>
            </li>

            <li>
              <a href="https://pytorch.org/vision/stable/index.html">torchvision</a>
            </li>

            <li>
              <a href="https://pytorch.org/elastic/">TorchElastic</a>
            </li>

            <li>
              <a href="https://pytorch.org/serve/">TorchServe</a>
            </li>

            <li>
              <a href="https://pytorch.org/xla">PyTorch on XLA Devices</a>
            </li>
          </ul>

          <li class="resources-mobile-menu-title">
            Resources
          </li>

          <ul class="resources-mobile-menu-items">
            <li>
              <a href="https://pytorch.org/resources">Developer Resources</a>
            </li>

            <li>
              <a href="https://pytorch.org/features">About</a>
            </li>

            <li>
              <a href="https://pytorch.org/hub">Models (Beta)</a>
            </li>

            <li>
              <a href="https://pytorch.org/#community-module">Community</a>
            </li>

            <li>
              <a href="https://discuss.pytorch.org/">Forums</a>
            </li>
          </ul>

          <li>
            <a href="https://github.com/pytorch/pytorch">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();
      filterTags.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>